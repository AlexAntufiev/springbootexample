# Spring boot tutorial
В данном туториале описано, как за несколько минут создать простое веб приложение с использованием spring boot.

## Step1 Создание нового проекта
Существует несколько вариантов создания spring проекта. 
### Ручная сборка проекта
Необходимо создать maven или gradle проект и затем добавить необходимые зависимости в pom.xml или build.gradle соответственно.
Подрбное описание здесь https://spring.io/guides/gs/maven/ и здесь https://spring.io/guides/gs/gradle/.

### Автоматическая сборка
Spring boot представляет систему автоматичесой инициализации проекта. Необходимо выбрать необходимые зависимости, систему сборки и нажать на кнопку generate project. Стандартное веб приложение будет включать следующие зависимости (используемые в данном проекте): web, devtools, mustache(или другой шаблонизатор), h2(или другая база данных). Более продвинутные технологии как например jpa и security не используются.  Далее будет скачан архив с проектом, в котором уже все настроено и есть класс с точкой входа в приложение.
Далее необходимо импортировать данный проект в вашу любимую ide. Если это intellij idea, не забудьте указать систему сборки.

Данный проект уже можно собрать и запустить. Смотри step 5. По умолчанию приложение будет запущено на порту 8080, с помощью embedded tomcat. При желании можно поменять на jetty. Для небольшого проекта этого вполне достаточно.

## Step2 Создание контроллеров
В данный момент, если задеплоить проект и обратиться по любому url следуя шаблону localhost:8080/* будет ошибка 404, потому что нет контроллеров отвечающих на запросы.
Контроллером можно считать клаcc, который помечен аннотацией @Controller. В нем описаны методы, которые будут вызваны при обращении к соответствующему url, который задается с помощью соответствуюзей аннотации, например @GetMapping("/path"). Существует несколько способов спецификации контроллера и все подробно описано здесь https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html. Ответы на вопросы также следует искать там. Простейший контроллер представлен в классе MainController. Он возвращает обьект ModelAndView, который принимает два параметра: строку и мапу. Строка представляет собой название html странички, которая будет искаться в папке resources/templates. А мапа, можно сказать, хранит значения параметров, которые будут вставлены в html страничку. Все это выполняется с помощью шаблонизатора (в данном случае mustache).

Для создания контроллера, который в рест стиле будет отвечать на запросы json обьектами или, другими словами, выполнять функцию классического api можно с помощью аннотации RestController. На самом деле он не сильно отличается от классического контроллера, разница создается с помощью аннотаций. Все подробно и доступно описано в вышеприведенной документации. Пример такого контроллера представлен в данном проекте классом ApiController. 


## Step3 Работа со статикой
Вся статика должна храниться в папке resources/static в других местах искать ее просто не будут. Если необходимо подключить стили к вашей html  страничке, следует создать папку css, положить туда необходимые файлы и обратиться из html. Стоит отметить, что путь надо указывать относительно папки static.

И еще, чтобы избежать возможных проблем, лучше добавить это spring.resources.chain.strategy.content.enabled=true в application.properties.

## Step4 Работа с базой данных
Покажем работу с базой на примере h2, потому что это самое простое и любимое мною (а также много фишек от спринга).
Настраивать базу данных можно либо с помощью класса конфигуратора, либо добавив несколько строк в application.properties. Что это за строчки можно посмотреть в данном проекте. Единственное, что стоит пояснить, это spring.h2.console.path=/h2. Данная строчка задает путь по которому будет доступен веб интерфейс базы (например localhost:8080/h2). Там можно смотреть за данными базы, а также выполнять некоторые sql запросы.
В spring boot присутствует механизм автоматической инициализации базы. В папке resources должны быть созданы файлы schema.sql и data.sql. Если они есть, то они последовательно выполнятся. Пример также присутсвтует в данном проекте.
Для работы с базой данных необходимо создать класс с аннотацией @Repository. Подключив к нему объект JdbcTemplate, вы получаете множество вариантов взаимодействия с базой. Например, можно просто выполнить query или же выполнить его, вернув класс, модель которого соответсвует данным, полученным из базы. Примеры на классах ScoreRepository и Score. С помощью DI можно подвязывать необходимые repository к соответсвующим контроллероам и работать с данными.

## Step5 Развертывание проекта
### Gradle
Для быстрого развертывания проекта, можно воспользоваться скриптом bootRun.
./gradlew bootRun

Если выполнить скрипт build
./gradlew build
То в папке build/libs появится полноценный jarник, который можно запустить с помощью команды java -jar.

### Maven
mvn spring-boot:run
